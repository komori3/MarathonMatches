#include "bits/stdc++.h"

using namespace std;
using pii = pair<int, int>;



// 地獄 from calcProb.py
double memo[37][9][4];

void initMemo() {
  memo[2][2][0] = 0.75; memo[2][2][1] = 0.25; memo[2][2][2] = 0.75; memo[2][2][3] = 0.25;
  memo[2][3][0] = 0.5555555555555556; memo[2][3][1] = 0.2222222222222222; memo[2][3][2] = 0.7777777777777778; memo[2][3][3] = 0.1111111111111111;
  memo[2][4][0] = 0.4375; memo[2][4][1] = 0.1875; memo[2][4][2] = 0.8125; memo[2][4][3] = 0.0625;
  memo[2][5][0] = 0.36; memo[2][5][1] = 0.16; memo[2][5][2] = 0.84; memo[2][5][3] = 0.04;
  memo[2][6][0] = 0.3055555555555556; memo[2][6][1] = 0.1388888888888889; memo[2][6][2] = 0.8611111111111112; memo[2][6][3] = 0.027777777777777776;
  memo[2][7][0] = 0.2653061224489796; memo[2][7][1] = 0.12244897959183673; memo[2][7][2] = 0.8775510204081632; memo[2][7][3] = 0.02040816326530612;
  memo[2][8][0] = 0.234375; memo[2][8][1] = 0.109375; memo[2][8][2] = 0.890625; memo[2][8][3] = 0.015625;
  memo[3][2][0] = 0.5; memo[3][2][1] = 0.5; memo[3][2][2] = 0.5; memo[3][2][3] = 0.5;
  memo[3][3][0] = 0.4074074074074074; memo[3][3][1] = 0.2962962962962963; memo[3][3][2] = 0.48148148148148145; memo[3][3][3] = 0.25925925925925924;
  memo[3][4][0] = 0.34375; memo[3][4][1] = 0.21875; memo[3][4][2] = 0.53125; memo[3][4][3] = 0.15625;
  memo[3][5][0] = 0.296; memo[3][5][1] = 0.176; memo[3][5][2] = 0.584; memo[3][5][3] = 0.104;
  memo[3][6][0] = 0.25925925925925924; memo[3][6][1] = 0.14814814814814814; memo[3][6][2] = 0.6296296296296297; memo[3][6][3] = 0.07407407407407407;
  memo[3][7][0] = 0.2303206997084548; memo[3][7][1] = 0.1282798833819242; memo[3][7][2] = 0.6676384839650146; memo[3][7][3] = 0.05539358600583091;
  memo[3][8][0] = 0.20703125; memo[3][8][1] = 0.11328125; memo[3][8][2] = 0.69921875; memo[3][8][3] = 0.04296875;
  memo[4][2][0] = 0.4375; memo[4][2][1] = 0.5625; memo[4][2][2] = 0.6875; memo[4][2][3] = 0.3125;
  memo[4][3][0] = 0.3333333333333333; memo[4][3][1] = 0.3333333333333333; memo[4][3][2] = 0.7777777777777778; memo[4][3][3] = 0.1111111111111111;
  memo[4][4][0] = 0.26171875; memo[4][4][1] = 0.24609375; memo[4][4][2] = 0.84765625; memo[4][4][3] = 0.05078125;
  memo[4][5][0] = 0.2128; memo[4][5][1] = 0.1968; memo[4][5][2] = 0.8912; memo[4][5][3] = 0.0272;
  memo[4][6][0] = 0.17824074074074073; memo[4][6][1] = 0.16435185185185186; memo[4][6][2] = 0.9189814814814815; memo[4][6][3] = 0.016203703703703703;
  memo[4][7][0] = 0.15285297792586422; memo[4][7][1] = 0.1411911703456893; memo[4][7][2] = 0.9375260308204915; memo[4][7][3] = 0.010412328196584756;
  memo[4][8][0] = 0.133544921875; memo[4][8][1] = 0.123779296875; memo[4][8][2] = 0.950439453125; memo[4][8][3] = 0.007080078125;
  memo[5][2][0] = 0.375; memo[5][2][1] = 0.625; memo[5][2][2] = 0.5; memo[5][2][3] = 0.5;
  memo[5][3][0] = 0.29218106995884774; memo[5][3][1] = 0.35390946502057613; memo[5][3][2] = 0.49794238683127573; memo[5][3][3] = 0.25102880658436216;
  memo[5][4][0] = 0.25; memo[5][4][1] = 0.25; memo[5][4][2] = 0.6015625; memo[5][4][3] = 0.1328125;
  memo[5][5][0] = 0.21408; memo[5][5][1] = 0.19648; memo[5][5][2] = 0.69152; memo[5][5][3] = 0.07712;
  memo[5][6][0] = 0.18467078189300412; memo[5][6][1] = 0.16306584362139917; memo[5][6][2] = 0.7582304526748971; memo[5][6][3] = 0.04835390946502058;
  memo[5][7][0] = 0.16106384244659963; memo[5][7][1] = 0.13982269292556673; memo[5][7][2] = 0.8068661867079193; memo[5][7][3] = 0.03218896888201345;
  memo[5][8][0] = 0.14208984375; memo[5][8][1] = 0.12255859375; memo[5][8][2] = 0.8427734375; memo[5][8][3] = 0.0224609375;
  memo[6][2][0] = 0.375; memo[6][2][1] = 0.625; memo[6][2][2] = 0.65625; memo[6][2][3] = 0.34375;
  memo[6][3][0] = 0.24554183813443073; memo[6][3][1] = 0.3772290809327846; memo[6][3][2] = 0.5528120713305898; memo[6][3][3] = 0.22359396433470508;
  memo[6][4][0] = 0.2236328125; memo[6][4][1] = 0.2587890625; memo[6][4][2] = 0.689453125; memo[6][4][3] = 0.103515625;
  memo[6][5][0] = 0.19488; memo[6][5][1] = 0.20128; memo[6][5][2] = 0.79392; memo[6][5][3] = 0.05152;
  memo[6][6][0] = 0.16838134430727023; memo[6][6][1] = 0.16632373113854595; memo[6][6][2] = 0.8600394375857339; memo[6][6][3] = 0.027992112482853222;
  memo[6][7][0] = 0.14652908227014255; memo[6][7][1] = 0.14224515295497625; memo[6][7][2] = 0.9017246215437446; memo[6][7][3] = 0.016379229742709247;
  memo[6][8][0] = 0.1289520263671875; memo[6][8][1] = 0.1244354248046875; memo[6][8][2] = 0.9287567138671875; memo[6][8][3] = 0.0101776123046875;
  memo[7][2][0] = 0.359375; memo[7][2][1] = 0.640625; memo[7][2][2] = 0.5; memo[7][2][3] = 0.5;
  memo[7][3][0] = 0.24554183813443073; memo[7][3][1] = 0.3772290809327846; memo[7][3][2] = 0.5637860082304527; memo[7][3][3] = 0.21810699588477367;
  memo[7][4][0] = 0.2108154296875; memo[7][4][1] = 0.2630615234375; memo[7][4][2] = 0.6575927734375; memo[7][4][3] = 0.1141357421875;
  memo[7][5][0] = 0.1855616; memo[7][5][1] = 0.2036096; memo[7][5][2] = 0.7505024; memo[7][5][3] = 0.0623744;
  memo[7][6][0] = 0.16291580932784636; memo[7][6][1] = 0.16741683813443073; memo[7][6][2] = 0.8193158436213992; memo[7][6][3] = 0.03613683127572016;
  memo[7][7][0] = 0.14352741751189677; memo[7][7][1] = 0.14274543041468388; memo[7][7][2] = 0.8671909056357713; memo[7][7][3] = 0.022134849060704783;
  memo[7][8][0] = 0.12738323211669922; memo[7][8][1] = 0.12465953826904297; memo[7][8][2] = 0.9003915786743164; memo[7][8][3] = 0.014229774475097656;
  memo[8][2][0] = 0.37109375; memo[8][2][1] = 0.62890625; memo[8][2][2] = 0.63671875; memo[8][2][3] = 0.36328125;
  memo[8][3][0] = 0.22542295381801555; memo[8][3][1] = 0.3872885230909922; memo[8][3][2] = 0.4997713763145862; memo[8][3][3] = 0.2501143118427069;
  memo[8][4][0] = 0.1921844482421875; memo[8][4][1] = 0.2692718505859375; memo[8][4][2] = 0.5566558837890625; memo[8][4][3] = 0.1477813720703125;
  memo[8][5][0] = 0.1781888; memo[8][5][1] = 0.2054528; memo[8][5][2] = 0.7003264; memo[8][5][3] = 0.0749184;
  memo[8][6][0] = 0.15974544181527206; memo[8][6][1] = 0.16805091163694558; memo[8][6][2] = 0.805250128600823; memo[8][6][3] = 0.03894997427983539;
  memo[8][7][0] = 0.14158944948836916; memo[8][7][1] = 0.14306842508527182; memo[8][7][2] = 0.8717808299020209; memo[8][7][3] = 0.021369861682996517;
  memo[8][8][0] = 0.1257597804069519; memo[8][8][1] = 0.12489145994186401; memo[8][8][2] = 0.9133737683296204; memo[8][8][3] = 0.012375175952911377;
  memo[9][2][0] = 0.3671875; memo[9][2][1] = 0.6328125; memo[9][2][2] = 0.5; memo[9][2][3] = 0.5;
  memo[9][3][0] = 0.22064725905603821; memo[9][3][1] = 0.3896763704719809; memo[9][3][2] = 0.4743687446019408; memo[9][3][3] = 0.2628156276990296;
  memo[9][4][0] = 0.1784515380859375; memo[9][4][1] = 0.2738494873046875; memo[9][4][2] = 0.5283660888671875; memo[9][4][3] = 0.1572113037109375;
  memo[9][5][0] = 0.169122304; memo[9][5][1] = 0.207719424; memo[9][5][2] = 0.677413376; memo[9][5][3] = 0.080646656;
  memo[9][6][0] = 0.1544396655743535; memo[9][6][1] = 0.1691120668851293; memo[9][6][2] = 0.7886937649240461; memo[9][6][3] = 0.042261247015190774;
  memo[9][7][0] = 0.13847195865291545; memo[9][7][1] = 0.14358800689118076; memo[9][7][2] = 0.8601075239692947; memo[9][7][3] = 0.02331541267178421;
  memo[9][8][0] = 0.12387117743492126; memo[9][8][1] = 0.12516126036643982; memo[9][8][2] = 0.905101090669632; memo[9][8][3] = 0.013556987047195435;
  memo[10][2][0] = 0.37890625; memo[10][2][1] = 0.62109375; memo[10][2][2] = 0.623046875; memo[10][2][3] = 0.376953125;
  memo[10][3][0] = 0.21973276431438296; memo[10][3][1] = 0.39013361784280853; memo[10][3][2] = 0.5298480922623584; memo[10][3][3] = 0.2350759538688208;
  memo[10][4][0] = 0.17140769958496094; memo[10][4][1] = 0.2761974334716797; memo[10][4][2] = 0.5549221038818359; memo[10][4][3] = 0.1483592987060547;
  memo[10][5][0] = 0.1595462656; memo[10][5][1] = 0.2101134336; memo[10][5][2] = 0.6547395584; memo[10][5][3] = 0.0863151104;
  memo[10][6][0] = 0.14902969885180103; memo[10][6][1] = 0.1701940602296398; memo[10][6][2] = 0.768810748012244; memo[10][6][3] = 0.04623785039755118;
  memo[10][7][0] = 0.13570209473467887; memo[10][7][1] = 0.14404965087755353; memo[10][7][2] = 0.8505378218110713; memo[10][7][3] = 0.024910363031488116;
  memo[10][8][0] = 0.12235947884619236; memo[10][8][1] = 0.1253772173076868; memo[10][8][2] = 0.902929512783885; memo[10][8][3] = 0.013867212459445;
  memo[11][2][0] = 0.3779296875; memo[11][2][1] = 0.6220703125; memo[11][2][2] = 0.5; memo[11][2][3] = 0.5;
  memo[11][3][0] = 0.2184908578750981; memo[11][3][1] = 0.390754571062451; memo[11][3][2] = 0.4612496965796768; memo[11][3][3] = 0.26937515171016163;
  memo[11][4][0] = 0.1672506332397461; memo[11][4][1] = 0.27758312225341797; memo[11][4][2] = 0.5115261077880859; memo[11][4][3] = 0.1628246307373047;
  memo[11][5][0] = 0.1509086208; memo[11][5][1] = 0.2122728448; memo[11][5][2] = 0.594960896; memo[11][5][3] = 0.101259776;
  memo[11][6][0] = 0.1442033366444958; memo[11][6][1] = 0.17115933267110084; memo[11][6][2] = 0.7297147857781955; memo[11][6][3] = 0.0540570428443609;
  memo[11][7][0] = 0.1332989653496028; memo[11][7][1] = 0.14445017244173286; memo[11][7][2] = 0.8286941117854492; memo[11][7][3] = 0.028550981369091816;
  memo[11][8][0] = 0.12111993972212076; memo[11][8][1] = 0.12555429432541132; memo[11][8][2] = 0.8912266492843628; memo[11][8][3] = 0.015539050102233887;
  memo[12][2][0] = 0.3876953125; memo[12][2][1] = 0.6123046875; memo[12][2][2] = 0.61279296875; memo[12][2][3] = 0.38720703125;
  memo[12][3][0] = 0.21672960874302133; memo[12][3][1] = 0.3916351956284893; memo[12][3][2] = 0.4614980778675337; memo[12][3][3] = 0.26925096106623314;
  memo[12][4][0] = 0.16149568557739258; memo[12][4][1] = 0.27950143814086914; memo[12][4][2] = 0.48010993003845215; memo[12][4][3] = 0.17329668998718262;
  memo[12][5][0] = 0.142503399424; memo[12][5][1] = 0.214374150144; memo[12][5][2] = 0.554555396096; memo[12][5][3] = 0.111361150976;
  memo[12][6][0] = 0.1383719221800962; memo[12][6][1] = 0.17232561556398077; memo[12][6][2] = 0.6939622216780061; memo[12][6][3] = 0.061207555664398776;
  memo[12][7][0] = 0.1301931097036847; memo[12][7][1] = 0.14496781504938588; memo[12][7][2] = 0.8059682002837157; memo[12][7][3] = 0.032338633286047365;
  memo[12][8][0] = 0.1195544368820265; memo[12][8][1] = 0.12577793758828193; memo[12][8][2] = 0.8789742514491081; memo[12][8][3] = 0.01728939265012741;
  memo[13][2][0] = 0.387451171875; memo[13][2][1] = 0.612548828125; memo[13][2][2] = 0.5; memo[13][2][3] = 0.5;
  memo[13][3][0] = 0.22112520486752058; memo[13][3][1] = 0.38943739756623974; memo[13][3][2] = 0.49497686478837727; memo[13][3][3] = 0.2525115676058114;
  memo[13][4][0] = 0.15755444765090942; memo[13][4][1] = 0.2808151841163635; memo[13][4][2] = 0.469951868057251; memo[13][4][3] = 0.176682710647583;
  memo[13][5][0] = 0.1368039038976; memo[13][5][1] = 0.2157990240256; memo[13][5][2] = 0.5426792505344; memo[13][5][3] = 0.1143301873664;
  memo[13][6][0] = 0.13227437867265016; memo[13][6][1] = 0.17354512426546997; memo[13][6][2] = 0.6629012612494849; memo[13][6][3] = 0.06741974775010302;
  memo[13][7][0] = 0.12668337221569162; memo[13][7][1] = 0.14555277129738473; memo[13][7][2] = 0.7821259753059169; memo[13][7][3] = 0.03631233744901386;
  memo[13][8][0] = 0.11777725638239644; memo[13][8][1] = 0.1260318205168005; memo[13][8][2] = 0.8648465304722777; memo[13][8][3] = 0.019307638503960334;
  memo[14][2][0] = 0.3953857421875; memo[14][2][1] = 0.6046142578125; memo[14][2][2] = 0.604736328125; memo[14][2][3] = 0.395263671875;
  memo[14][3][0] = 0.22143547240218367; memo[14][3][1] = 0.3892822637989082; memo[14][3][2] = 0.4503694253506556; memo[14][3][3] = 0.2748152873246722;
  memo[14][4][0] = 0.15708740800619125; memo[14][4][1] = 0.28097086399793625; memo[14][4][2] = 0.4746791943907738; memo[14][4][3] = 0.1751069352030754;
  memo[14][5][0] = 0.1330829860864; memo[14][5][1] = 0.2167292534784; memo[14][5][2] = 0.5324060499968; memo[14][5][3] = 0.1168984875008;
  memo[14][6][0] = 0.1262558492154582; memo[14][6][1] = 0.17474883015690837; memo[14][6][2] = 0.6261002434211431; memo[14][6][3] = 0.07477995131577139;
  memo[14][7][0] = 0.12288036673968321; memo[14][7][1] = 0.14618660554338614; memo[14][7][2] = 0.7513846635477986; memo[14][7][3] = 0.04143588940870022;
  memo[14][8][0] = 0.11581179304221223; memo[14][8][1] = 0.12631260099396968; memo[14][8][2] = 0.8455932283272887; memo[14][8][3] = 0.02205811023895876;
  memo[15][2][0] = 0.39532470703125; memo[15][2][1] = 0.60467529296875; memo[15][2][2] = 0.5; memo[15][2][3] = 0.5;
  memo[15][3][0] = 0.2229731504985014; memo[15][3][1] = 0.3885134247507493; memo[15][3][2] = 0.4464014576162491; memo[15][3][3] = 0.2767992711918755;
  memo[15][4][0] = 0.15651487931609154; memo[15][4][1] = 0.28116170689463615; memo[15][4][2] = 0.46015704423189163; memo[15][4][3] = 0.1799476519227028;
  memo[15][5][0] = 0.129994097197056; memo[15][5][1] = 0.217501475700736; memo[15][5][2] = 0.509400768610304; memo[15][5][3] = 0.122649807847424;
  memo[15][6][0] = 0.12068511242903787; memo[15][6][1] = 0.17586297751419241; memo[15][6][2] = 0.5890751801565247; memo[15][6][3] = 0.08218496396869505;
  memo[15][7][0] = 0.11873116325685429; memo[15][7][1] = 0.14687813945719094; memo[15][7][2] = 0.7171811885781927; memo[15][7][3] = 0.04713646857030122;
  memo[15][8][0] = 0.11354142103118647; memo[15][8][1] = 0.12663693985268765; memo[15][8][2] = 0.8230244369772208; memo[15][8][3] = 0.025282223288968453;
  memo[16][2][0] = 0.4018402099609375; memo[16][2][1] = 0.5981597900390625; memo[16][2][2] = 0.5981903076171875; memo[16][2][3] = 0.4018096923828125;
  memo[16][3][0] = 0.2266028810882018; memo[16][3][1] = 0.3866985594558991; memo[16][3][2] = 0.47750719503118483; memo[16][3][3] = 0.26124640248440756;
  memo[16][4][0] = 0.155699823750183; memo[16][4][1] = 0.28143339208327234; memo[16][4][2] = 0.4433650600258261; memo[16][4][3] = 0.1855449799913913;
  memo[16][5][0] = 0.1270014254841856; memo[16][5][1] = 0.2182496436289536; memo[16][5][2] = 0.4849693770973184; memo[16][5][3] = 0.1287576557256704;
  memo[16][6][0] = 0.11605117883770583; memo[16][6][1] = 0.17678976423245885; memo[16][6][2] = 0.5627151623392608; memo[16][6][3] = 0.08745696753214785;
  memo[16][7][0] = 0.11436372243835585; memo[16][7][1] = 0.14760604626027402; memo[16][7][2] = 0.6842817665886042; memo[16][7][3] = 0.05261970556856597;
  memo[16][8][0] = 0.11094244370103112; memo[16][8][1] = 0.12700822232842413; memo[16][8][2] = 0.798533820397541; memo[16][8][3] = 0.028780882800351293;
  memo[17][2][0] = 0.401824951171875; memo[17][2][1] = 0.598175048828125; memo[17][2][2] = 0.5; memo[17][2][3] = 0.5;
  memo[17][3][0] = 0.22824334672707514; memo[17][3][1] = 0.38587832663646243; memo[17][3][2] = 0.43964678130381485; memo[17][3][3] = 0.2801766093480926;
  memo[17][4][0] = 0.15559092187322676; memo[17][4][1] = 0.2814696927089244; memo[17][4][2] = 0.4333475122693926; memo[17][4][3] = 0.18888416257686913;
  memo[17][5][0] = 0.12452790653288448; memo[17][5][1] = 0.21886802336677888; memo[17][5][2] = 0.4679117133853491; memo[17][5][3] = 0.13302207165366273;
  memo[17][6][0] = 0.1124982165071083; memo[17][6][1] = 0.17750035669857833; memo[17][6][2] = 0.5449730699535482; memo[17][6][3] = 0.09100538600929035;
  memo[17][7][0] = 0.10998353942840886; memo[17][7][1] = 0.14833607676193186; memo[17][7][2] = 0.6518312824690741; memo[17][7][3] = 0.058028119588487664;
  memo[17][8][0] = 0.10804747055203201; memo[17][8][1] = 0.12742178992113828; memo[17][8][2] = 0.7709281619046191; memo[17][8][3] = 0.03272454829934013;
  memo[18][2][0] = 0.4072723388671875; memo[18][2][1] = 0.5927276611328125; memo[18][2][2] = 0.5927352905273438; memo[18][2][3] = 0.40726470947265625;
  memo[18][3][0] = 0.22982953542242832; memo[18][3][1] = 0.38508523228878583; memo[18][3][2] = 0.43785209047113666; memo[18][3][3] = 0.2810739547644317;
  memo[18][4][0] = 0.15656306888558902; memo[18][4][1] = 0.28114564370480366; memo[18][4][2] = 0.4407167225435842; memo[18][4][3] = 0.1864277591521386;
  memo[18][5][0] = 0.12309434442527539; memo[18][5][1] = 0.21922641389368117; memo[18][5][2] = 0.4632348566688891; memo[18][5][3] = 0.13419128583277773;
  memo[18][6][0] = 0.10976661635897358; memo[18][6][1] = 0.1780466767282053; memo[18][6][2] = 0.5306103870389381; memo[18][6][3] = 0.09387792259221238;
  memo[18][7][0] = 0.10578670728253911; memo[18][7][1] = 0.14903554878624348; memo[18][7][2] = 0.620594747031879; memo[18][7][3] = 0.06323420882802017;
  memo[18][8][0] = 0.10489108432127281; memo[18][8][1] = 0.12787270223981817; memo[18][8][2] = 0.7407870345308757; memo[18][8][3] = 0.03703042363844633;
  memo[19][2][0] = 0.4072685241699219; memo[19][2][1] = 0.5927314758300781; memo[19][2][2] = 0.5; memo[19][2][3] = 0.5;
  memo[19][3][0] = 0.23314705743402228; memo[19][3][1] = 0.38342647128298885; memo[19][3][2] = 0.4635875801602222; memo[19][3][3] = 0.26820620991988886;
  memo[19][4][0] = 0.1575118418695638; memo[19][4][1] = 0.28082938604347873; memo[19][4][2] = 0.43246030039153993; memo[19][4][3] = 0.1891798998694867;
  memo[19][5][0] = 0.12244289422544077; memo[19][5][1] = 0.2193892764436398; memo[19][5][2] = 0.45645572923641037; memo[19][5][3] = 0.1358860676908974;
  memo[19][6][0] = 0.10751501046973914; memo[19][6][1] = 0.17849699790605217; memo[19][6][2] = 0.5136206678981204; memo[19][6][3] = 0.0972758664203759;
  memo[19][7][0] = 0.10202580616309183; memo[19][7][1] = 0.1496623656394847; memo[19][7][2] = 0.5928585351170634; memo[19][7][3] = 0.06785691081382275;
  memo[19][8][0] = 0.10157378419681379; memo[19][8][1] = 0.12834660225759803; memo[19][8][2] = 0.7099273655720529; memo[19][8][3] = 0.04143894777542101;
  memo[20][2][0] = 0.41190338134765625; memo[20][2][1] = 0.5880966186523438; memo[20][2][2] = 0.5880985260009766; memo[20][2][3] = 0.41190147399902344;
  memo[20][3][0] = 0.23468905469615814; memo[20][3][1] = 0.3826554726519209; memo[20][3][2] = 0.4324287049602411; memo[20][3][3] = 0.28378564751987945;
  memo[20][4][0] = 0.15828429965949908; memo[20][4][1] = 0.2805719001135003; memo[20][4][2] = 0.41978837325768836; memo[20][4][3] = 0.19340387558077055;
  memo[20][5][0] = 0.1220284303898103; memo[20][5][1] = 0.21949289240254743; memo[20][5][2] = 0.4459283014739506; memo[20][5][3] = 0.13851792463151236;
  memo[20][6][0] = 0.10548098070748631; memo[20][6][1] = 0.17890380385850274; memo[20][6][2] = 0.49492994159754666; memo[20][6][3] = 0.10101401168049066;
  memo[20][7][0] = 0.09883823299407718; memo[20][7][1] = 0.15019362783432047; memo[20][7][2] = 0.5701435209170751; memo[20][7][3] = 0.07164274651382083;
  memo[20][8][0] = 0.09821032538586005; memo[20][8][1] = 0.12882709637344855; memo[20][8][2] = 0.679503871621704; memo[20][8][3] = 0.045785161196899425;
  memo[21][2][0] = 0.41190242767333984; memo[21][2][1] = 0.5880975723266602; memo[21][2][2] = 0.5; memo[21][2][3] = 0.5;
  memo[21][3][0] = 0.23628684892696925; memo[21][3][1] = 0.38185657553651536; memo[21][3][2] = 0.430627558896206; memo[21][3][3] = 0.28468622055189696;
  memo[21][4][0] = 0.15907897114766456; memo[21][4][1] = 0.28030700961744515; memo[21][4][2] = 0.4140116834255423; memo[21][4][3] = 0.19532943885815257;
  memo[21][5][0] = 0.12164738976362109; memo[21][5][1] = 0.21958815255909472; memo[21][5][2] = 0.43428741740005583; memo[21][5][3] = 0.14142814564998604;
  memo[21][6][0] = 0.10367344071323453; memo[21][6][1] = 0.1792653118573531; memo[21][6][2] = 0.4779308200178403; memo[21][6][3] = 0.10441383599643193;
  memo[21][7][0] = 0.09622866207576634; memo[21][7][1] = 0.1506285563207056; memo[21][7][2] = 0.5518379338327343; memo[21][7][3] = 0.07469367769454428;
  memo[21][8][0] = 0.09491925163874584; memo[21][8][1] = 0.12929724976589346; memo[21][8][2] = 0.650294232844138; memo[21][8][3] = 0.049957966736551715;
  memo[22][2][0] = 0.4159064292907715; memo[22][2][1] = 0.5840935707092285; memo[22][2][2] = 0.5840940475463867; memo[22][2][3] = 0.4159059524536133;
  memo[22][3][0] = 0.23898893512343666; memo[22][3][1] = 0.38050553243828167; memo[22][3][2] = 0.4533122189067252; memo[22][3][3] = 0.2733438905466374;
  memo[22][4][0] = 0.16045245770351357; memo[22][4][1] = 0.2798491807654955; memo[22][4][2] = 0.4199631366795984; memo[22][4][3] = 0.19334562110680054;
  memo[22][5][0] = 0.1214087663169015; memo[22][5][1] = 0.2196478084207746; memo[22][5][2] = 0.42549297383706647; memo[22][5][3] = 0.14362675654073337;
  memo[22][6][0] = 0.10226450807890088; memo[22][6][1] = 0.1795470983842198; memo[22][6][2] = 0.46601472229820085; memo[22][6][3] = 0.10679705554035983;
  memo[22][7][0] = 0.09409644334124867; memo[22][7][1] = 0.1509839261097919; memo[22][7][2] = 0.5362711721187622; memo[22][7][3] = 0.0772881379802063;
  memo[22][8][0] = 0.09182466077542216; memo[22][8][1] = 0.12973933417493969; memo[22][8][2] = 0.6233767149366394; memo[22][8][3] = 0.05380332643762295;
  memo[23][2][0] = 0.4159061908721924; memo[23][2][1] = 0.5840938091278076; memo[23][2][2] = 0.5; memo[23][2][3] = 0.5;
  memo[23][3][0] = 0.24042416909028938; memo[23][3][1] = 0.3797879154548553; memo[23][3][2] = 0.4263536752116602; memo[23][3][3] = 0.28682316239416994;
  memo[23][4][0] = 0.16176721762761304; memo[23][4][1] = 0.2794109274574623; memo[23][4][2] = 0.4136654529618511; memo[23][4][3] = 0.1954448490127163;
  memo[23][5][0] = 0.12157582167689908; memo[23][5][1] = 0.21960604458077523; memo[23][5][2] = 0.422178375050355; memo[23][5][3] = 0.14445540623741127;
  memo[23][6][0] = 0.10130947722177398; memo[23][6][1] = 0.1797381045556452; memo[23][6][2] = 0.45796832734963017; memo[23][6][3] = 0.10840633453007396;
  memo[23][7][0] = 0.09229871528281157; memo[23][7][1] = 0.15128354745286474; memo[23][7][2] = 0.5212816433650225; memo[23][7][3] = 0.07978639277249625;
  memo[23][8][0] = 0.08903420608939408; memo[23][8][1] = 0.130137970558658; memo[23][8][2] = 0.5995121497993349; memo[23][8][3] = 0.057212550028666445;
  memo[24][2][0] = 0.41940999031066895; memo[24][2][1] = 0.580590009689331; memo[24][2][2] = 0.5805901288986206; memo[24][2][3] = 0.4194098711013794;
  memo[24][3][0] = 0.24181713824253126; memo[24][3][1] = 0.37909143087873437; memo[24][3][2] = 0.42493863321223074; memo[24][3][3] = 0.28753068339388466;
  memo[24][4][0] = 0.16281626355166168; memo[24][4][1] = 0.27906124548277944; memo[24][4][2] = 0.4048067121045591; memo[24][4][3] = 0.19839776263181363;
  memo[24][5][0] = 0.12200423506051578; memo[24][5][1] = 0.21949894123487107; memo[24][5][2] = 0.41870119041098497; memo[24][5][3] = 0.14532470239725376;
  memo[24][6][0] = 0.10071350332914848; memo[24][6][1] = 0.1798572993341703; memo[24][6][2] = 0.4506414196529054; memo[24][6][3] = 0.10987171606941892;
  memo[24][7][0] = 0.09071629600114804; memo[24][7][1] = 0.15154728399980866; memo[24][7][2] = 0.5059390441782933; memo[24][7][3] = 0.08234349263695113;
  memo[24][8][0] = 0.086605070122517; memo[24][8][1] = 0.13048498998249758; memo[24][8][2] = 0.5789173212757075; memo[24][8][3] = 0.06015466838918464;
  memo[25][2][0] = 0.41940993070602417; memo[25][2][1] = 0.5805900692939758; memo[25][2][2] = 0.5; memo[25][2][3] = 0.5;
  memo[25][3][0] = 0.24407827493037065; memo[25][3][1] = 0.37796086253481465; memo[25][3][2] = 0.4449812842035662; memo[25][3][3] = 0.2775093578982169;
  memo[25][4][0] = 0.1638292543726152; memo[25][4][1] = 0.27872358187579493; memo[25][4][2] = 0.40051892139036127; memo[25][4][3] = 0.1998270262032129;
  memo[25][5][0] = 0.12249990705495609; memo[25][5][1] = 0.21937502323626099; memo[25][5][2] = 0.4130574767883351; memo[25][5][3] = 0.1467356308029162;
  memo[25][6][0] = 0.1003190944808434; memo[25][6][1] = 0.1799361811038313; memo[25][6][2] = 0.4424271361353588; memo[25][6][3] = 0.11151457277292824;
  memo[25][7][0] = 0.08929791535801322; memo[25][7][1] = 0.15178368077366447; memo[25][7][2] = 0.49085362796007553; memo[25][7][3] = 0.08485772867332074;
  memo[25][8][0] = 0.08453599989116276; memo[25][8][1] = 0.13078057144411961; memo[25][8][2] = 0.5612177650031941; memo[25][8][3] = 0.06268317642811512;
  memo[26][2][0] = 0.4225095212459564; memo[26][2][1] = 0.5774904787540436; memo[26][2][2] = 0.577490508556366; memo[26][2][3] = 0.42250949144363403;
  memo[26][3][0] = 0.2453321101566364; memo[26][3][1] = 0.3773339449216818; memo[26][3][2] = 0.42137415863807265; memo[26][3][3] = 0.28931292068096365;
  memo[26][4][0] = 0.1651738401867311; memo[26][4][1] = 0.27827538660442297; memo[26][4][2] = 0.40499291897604905; memo[26][4][3] = 0.19833569367465032;
  memo[26][5][0] = 0.12296699059885148; memo[26][5][1] = 0.21925825235028712; memo[26][5][2] = 0.40618129148955495; memo[26][5][3] = 0.14845467712761126;
  memo[26][6][0] = 0.10001846416420826; memo[26][6][1] = 0.17999630716715834; memo[26][6][2] = 0.43343961682496085; memo[26][6][3] = 0.11331207663500784;
  memo[26][7][0] = 0.08806855145551058; memo[26][7][1] = 0.1519885747574149; memo[26][7][2] = 0.4774959339031734; memo[26][7][3] = 0.08708401101613777;
  memo[26][8][0] = 0.08278226140147824; memo[26][8][1] = 0.13103110551407454; memo[26][8][2] = 0.5456760939262213; memo[26][8][3] = 0.06490341515339695;
  memo[27][2][0] = 0.4225095063447952; memo[27][2][1] = 0.5774904936552048; memo[27][2][2] = 0.5; memo[27][2][3] = 0.5;
  memo[27][3][0] = 0.2465570236953315; memo[27][3][1] = 0.37672148815233425; memo[27][3][2] = 0.42013195267130754; memo[27][3][3] = 0.28993402366434623;
  memo[27][4][0] = 0.16640941105297147; memo[27][4][1] = 0.2778635296490095; memo[27][4][2] = 0.40039289044390824; memo[27][4][3] = 0.19986903651869725;
  memo[27][5][0] = 0.12345048861996213; memo[27][5][1] = 0.21913737784500947; memo[27][5][2] = 0.40025177637643966; memo[27][5][3] = 0.14993705590589007;
  memo[27][6][0] = 0.09979334274254839; memo[27][6][1] = 0.18004133145149032; memo[27][6][2] = 0.4249518418201466; memo[27][6][3] = 0.11500963163597068;
  memo[27][7][0] = 0.08707068038272982; memo[27][7][1] = 0.15215488660287838; memo[27][7][2] = 0.46661822414680193; memo[27][7][3] = 0.08889696264219968;
  memo[27][8][0] = 0.08127735496313962; memo[27][8][1] = 0.1312460921481229; memo[27][8][2] = 0.5313570838173582; memo[27][8][3] = 0.06694898802609169;
  memo[28][2][0] = 0.425277017056942; memo[28][2][1] = 0.574722982943058; memo[28][2][2] = 0.5747229903936386; memo[28][2][3] = 0.4252770096063614;
  memo[28][3][0] = 0.24845595572321635; memo[28][3][1] = 0.37577202213839184; memo[28][3][2] = 0.43815011097437906; memo[28][3][3] = 0.28092494451281047;
  memo[28][4][0] = 0.16744664032705733; memo[28][4][1] = 0.2775177865576476; memo[28][4][2] = 0.39353160089015027; memo[28][4][3] = 0.2021561330366166;
  memo[28][5][0] = 0.12407146903040392; memo[28][5][1] = 0.21898213274239903; memo[28][5][2] = 0.39810511401720683; memo[28][5][3] = 0.1504737214956983;
  memo[28][6][0] = 0.0997000223914055; memo[28][6][1] = 0.1800599955217189; memo[28][6][2] = 0.4186937908248703; memo[28][6][3] = 0.11626124183502595;
  memo[28][7][0] = 0.0863159533463626; memo[28][7][1] = 0.1522806744422729; memo[28][7][2] = 0.4579539785770343; memo[28][7][3] = 0.09034100357049428;
  memo[28][8][0] = 0.07995572489781799; memo[28][8][1] = 0.13143489644316886; memo[28][8][2] = 0.517561563103791; memo[28][8][3] = 0.06891977669945844;
  memo[29][2][0] = 0.4252770133316517; memo[29][2][1] = 0.5747229866683483; memo[29][2][2] = 0.5; memo[29][2][3] = 0.5;
  memo[29][3][0] = 0.24956058946714782; memo[29][3][1] = 0.3752197052664261; memo[29][3][2] = 0.41711605756964504; memo[29][3][3] = 0.2914419712151775;
  memo[29][4][0] = 0.16843404421920327; memo[29][4][1] = 0.27718865192693226; memo[29][4][2] = 0.39002001326205604; memo[29][4][3] = 0.2033266622459813;
  memo[29][5][0] = 0.12478849413107379; memo[29][5][1] = 0.21880287646723154; memo[29][5][2] = 0.39592467289225636; memo[29][5][3] = 0.1510188317769359;
  memo[29][6][0] = 0.09976677503413815; memo[29][6][1] = 0.18004664499317238; memo[29][6][2] = 0.41406468241521416; memo[29][6][3] = 0.11718706351695717;
  memo[29][7][0] = 0.08577382155265728; memo[29][7][1] = 0.1523710297412238; memo[29][7][2] = 0.45047833056982534; memo[29][7][3] = 0.09158694490502911;
  memo[29][8][0] = 0.07877254501866421; memo[29][8][1] = 0.13160392214019082; memo[29][8][2] = 0.5040912840587314; memo[29][8][3] = 0.07084410227732409;
  memo[30][2][0] = 0.42776777781546116; memo[30][2][1] = 0.5722322221845388; memo[30][2][2] = 0.572232224047184; memo[30][2][3] = 0.427767775952816;
  memo[30][3][0] = 0.25063355054134523; memo[30][3][1] = 0.37468322472932736; memo[30][3][2] = 0.4160409387678977; memo[30][3][3] = 0.29197953061605114;
  memo[30][4][0] = 0.16961224119817545; memo[30][4][1] = 0.2767959196006082; memo[30][4][2] = 0.39369252756815387; memo[30][4][3] = 0.20210249081061538;
  memo[30][5][0] = 0.1255109467853653; memo[30][5][1] = 0.21862226330365866; memo[30][5][2] = 0.39221416847532775; memo[30][5][3] = 0.15194645788116806;
  memo[30][6][0] = 0.09996235070552972; memo[30][6][1] = 0.18000752985889407; memo[30][6][2] = 0.40987668796411275; memo[30][6][3] = 0.11802466240717745;
  memo[30][7][0] = 0.08538619186003961; memo[30][7][1] = 0.1524356346899934; memo[30][7][2] = 0.4432462525633704; memo[30][7][3] = 0.09279229123943826;
  memo[30][8][0] = 0.07771294435169049; memo[30][8][1] = 0.1317552936640442; memo[30][8][2] = 0.4912940620569713; memo[30][8][3] = 0.0726722768490041;
  memo[31][2][0] = 0.4277677768841386; memo[31][2][1] = 0.5722322231158614; memo[31][2][2] = 0.5; memo[31][2][3] = 0.5;
  memo[31][3][0] = 0.25225629122108667; memo[31][3][1] = 0.3738718543894567; memo[31][3][2] = 0.4323887269860551; memo[31][3][3] = 0.28380563650697244;
  memo[31][4][0] = 0.17070364853877287; memo[31][4][1] = 0.2764321171537424; memo[31][4][2] = 0.39004704953849456; memo[31][4][3] = 0.20331765015383516;
  memo[31][5][0] = 0.12618858995245275; memo[31][5][1] = 0.2184528525118868; memo[31][5][2] = 0.38737320158453764; memo[31][5][3] = 0.1531566996038656;
  memo[31][6][0] = 0.10022842794538361; memo[31][6][1] = 0.17995431441092327; memo[31][6][2] = 0.4052743424695202; memo[31][6][3] = 0.11894513150609597;
  memo[31][7][0] = 0.08509685168170952; memo[31][7][1] = 0.15248385805304843; memo[31][7][2] = 0.43583056663784986; memo[31][7][3] = 0.09402823889369169;
  memo[31][8][0] = 0.07678454775609288; memo[31][8][1] = 0.13188792174912958; memo[31][8][2] = 0.47968306659731674; memo[31][8][3] = 0.0743309904860976;
  memo[32][2][0] = 0.4300250334199518; memo[32][2][1] = 0.5699749665800482; memo[32][2][2] = 0.5699749670457095; memo[32][2][3] = 0.4300250329542905;
  memo[32][3][0] = 0.25323201872361556; memo[32][3][1] = 0.3733839906381922; memo[32][3][2] = 0.41343812467308505; memo[32][3][3] = 0.2932809376634575;
  memo[32][4][0] = 0.17164552565055927; memo[32][4][1] = 0.2761181581164802; memo[32][4][2] = 0.38446198665129167; memo[32][4][3] = 0.20517933778290276;
  memo[32][5][0] = 0.12683615312684843; memo[32][5][1] = 0.2182909617182879; memo[32][5][2] = 0.3831320929989361; memo[32][5][3] = 0.15421697675026597;
  memo[32][6][0] = 0.10051750766279022; memo[32][6][1] = 0.17989649846744196; memo[32][6][2] = 0.4001420426906358; memo[32][6][3] = 0.11997159146187283;
  memo[32][7][0] = 0.08487316523104028; memo[32][7][1] = 0.15252113912815995; memo[32][7][2] = 0.4284040962432729; memo[32][7][3] = 0.09526598395945451;
  memo[32][8][0] = 0.07600071561019821; memo[32][8][1] = 0.13199989776997167; memo[32][8][2] = 0.46957243369753393; memo[32][8][3] = 0.075775366614638;
  memo[33][2][0] = 0.43002503318712115; memo[33][2][1] = 0.5699749668128788; memo[33][2][2] = 0.5; memo[33][2][3] = 0.5;
  memo[33][3][0] = 0.254181429372195; memo[33][3][1] = 0.3729092853139025; memo[33][3][2] = 0.41248723073573484; memo[33][3][3] = 0.29375638463213255;
  memo[33][4][0] = 0.17253324158345798; memo[33][4][1] = 0.275822252805514; memo[33][4][2] = 0.38158100882612506; memo[33][4][3] = 0.206139663724625;
  memo[33][5][0] = 0.12753401785103557; memo[33][5][1] = 0.2181164955372411; memo[33][5][2] = 0.3815150231262762; memo[33][5][3] = 0.15462124421843093;
  memo[33][6][0] = 0.10081635668535648; memo[33][6][1] = 0.1798367286629287; memo[33][6][2] = 0.3950712487569759; memo[33][6][3] = 0.12098575024860482;
  memo[33][7][0] = 0.08471380137894453; memo[33][7][1] = 0.1525476997701759; memo[33][7][2] = 0.4215978175101799; memo[33][7][3] = 0.09640036374830335;
  memo[33][8][0] = 0.07536604993657396; memo[33][8][1] = 0.13209056429477514; memo[33][8][2] = 0.46093109922829606; memo[33][8][3] = 0.07700984296738628;
  memo[34][2][0] = 0.4320831203367561; memo[34][2][1] = 0.5679168796632439; memo[34][2][2] = 0.5679168797796592; memo[34][2][3] = 0.4320831202203408;
  memo[34][3][0] = 0.2555858249510829; memo[34][3][1] = 0.3722070875244585; memo[34][3][2] = 0.42745529668331467; memo[34][3][3] = 0.2862723516583427;
  memo[34][4][0] = 0.17355038223815628; memo[34][4][1] = 0.2754832059206146; memo[34][4][2] = 0.38461679130710363; memo[34][4][3] = 0.20512773623096545;
  memo[34][5][0] = 0.12826692136800485; memo[34][5][1] = 0.21793326965799878; memo[34][5][2] = 0.37986938111943164; memo[34][5][3] = 0.1550326547201421;
  memo[34][6][0] = 0.10115070351774495; memo[34][6][1] = 0.179769859296451; memo[34][6][2] = 0.3910409877099561; memo[34][6][3] = 0.12179180245800879;
  memo[34][7][0] = 0.084631370073104; memo[34][7][1] = 0.15256143832114932; memo[34][7][2] = 0.41581633697264075; memo[34][7][3] = 0.09736394383789321;
  memo[34][8][0] = 0.0748701709076017; memo[34][8][1] = 0.1321614041560569; memo[34][8][2] = 0.4534072528687483; memo[34][8][3] = 0.07808467816160738;
  memo[35][2][0] = 0.43208312027854845; memo[35][2][1] = 0.5679168797214516; memo[35][2][2] = 0.5; memo[35][2][3] = 0.5;
  memo[35][3][0] = 0.25645545393361013; memo[35][3][1] = 0.37177227303319493; memo[35][3][2] = 0.4102121029471965; memo[35][3][3] = 0.2948939485264017;
  memo[35][4][0] = 0.1744997163615311; memo[35][4][1] = 0.27516676121282296; memo[35][4][2] = 0.381607036467644; memo[35][4][3] = 0.20613098784411868;
  memo[35][5][0] = 0.1289871073574112; memo[35][5][1] = 0.2177532231606472; memo[35][5][2] = 0.37707515724413393; memo[35][5][3] = 0.1557312106889665;
  memo[35][6][0] = 0.10153623590359435; memo[35][6][1] = 0.17969275281928113; memo[35][6][2] = 0.38792059324728656; memo[35][6][3] = 0.12241588135054268;
  memo[35][7][0] = 0.08463301575092118; memo[35][7][1] = 0.15256116404151313; memo[35][7][2] = 0.41098199439608063; memo[35][7][3] = 0.09816966760065322;
  memo[35][8][0] = 0.07448991673032057; memo[35][8][1] = 0.13221572618138278; memo[35][8][2] = 0.44652386215171785; memo[35][8][3] = 0.07906801969261174;
  memo[36][2][0] = 0.43396970024332404; memo[36][2][1] = 0.566030299756676; memo[36][2][2] = 0.5660302997857798; memo[36][2][3] = 0.4339697002142202;
  memo[36][3][0] = 0.25730208493898477; memo[36][3][1] = 0.3713489575305076; memo[36][3][2] = 0.4093652684891701; memo[36][3][3] = 0.29531736575541495;
  memo[36][4][0] = 0.17533211224533993; memo[36][4][1] = 0.27488929591822003; memo[36][4][2] = 0.37696918266187046; memo[36][4][3] = 0.20767693911270985;
  memo[36][5][0] = 0.12966181383412295; memo[36][5][1] = 0.21758454654146925; memo[36][5][2] = 0.3734499059898798; memo[36][5][3] = 0.15663752350253005;
  memo[36][6][0] = 0.10196481534314221; memo[36][6][1] = 0.17960703693137156; memo[36][6][2] = 0.3850976141261178; memo[36][6][3] = 0.12298047717477643;
  memo[36][7][0] = 0.0847109109051026; memo[36][7][1] = 0.15254818151581623; memo[36][7][2] = 0.4067103283797134; memo[36][7][3] = 0.09888161193671444;
  memo[36][8][0] = 0.07419709233385052; memo[36][8][1] = 0.13225755823802135; memo[36][8][2] = 0.43989203430722806; memo[36][8][3] = 0.08001542367039599;
}

double w[6][11][5];

void initWeight() {
  w[1][1][0] = -0.0175030106; w[1][1][1] = 0.6374634667; w[1][1][2] = -1.0000000000;
  w[1][2][0] = -0.0222273082; w[1][2][1] = -0.2303280845; w[1][2][2] = 1.0000000000;
  w[1][3][0] = -0.0212029288; w[1][3][1] = -0.2492257234; w[1][3][2] = 1.0000000000;
  w[1][4][0] = -0.0099374113; w[1][4][1] = -0.2094534924; w[1][4][2] = 1.0000000000;
  w[1][5][0] = -0.0101736451; w[1][5][1] = -0.1661760085; w[1][5][2] = 1.0000000000;
  w[1][6][0] = -0.0116777004; w[1][6][1] = -0.1477974067; w[1][6][2] = 1.0000000000;
  w[1][7][0] = -0.0111510055; w[1][7][1] = -0.1571120602; w[1][7][2] = 1.0000000000;
  w[1][8][0] = -0.0118492082; w[1][8][1] = -0.1435667938; w[1][8][2] = 1.0000000000;
  w[1][9][0] = -0.0090794392; w[1][9][1] = -0.1414363005; w[1][9][2] = 1.0000000000;
  w[1][10][0] = -0.0093321572; w[1][10][1] = -0.1264869505; w[1][10][2] = 1.0000000000;
  w[2][1][0] = -0.0285014783; w[2][1][1] = 0.9449145654; w[2][1][2] = -1.0000000000;
  w[2][2][0] = 0.0003381375; w[2][2][1] = -0.3203815578; w[2][2][2] = 1.0000000000;
  w[2][3][0] = 0.2113184558; w[2][3][1] = -1.3412412934; w[2][3][2] = 1.0000000000;
  w[2][4][0] = -0.0102072226; w[2][4][1] = 0.5564768676; w[2][4][2] = -1.0000000000;
  w[2][5][0] = 0.0597854074; w[2][5][1] = -0.1040982380; w[2][5][2] = -1.0000000000;
  w[2][6][0] = 0.0409416034; w[2][6][1] = -0.4472272331; w[2][6][2] = 1.0000000000;
  w[2][7][0] = 0.0774603258; w[2][7][1] = -0.2225033541; w[2][7][2] = -1.0000000000;
  w[2][8][0] = 0.2590588481; w[2][8][1] = -1.6489414170; w[2][8][2] = 1.0000000000;
  w[2][9][0] = 0.0336100807; w[2][9][1] = -0.4476131149; w[2][9][2] = 1.0000000000;
  w[2][10][0] = 0.0786953837; w[2][10][1] = -0.7019081148; w[2][10][2] = 1.0000000000;
  w[3][1][0] = -0.0015571199; w[3][1][1] = 0.5216036869; w[3][1][2] = -1.0000000000;
  w[3][2][0] = -0.0202845393; w[3][2][1] = -0.2257054842; w[3][2][2] = 1.0000000000;
  w[3][3][0] = -0.0257209217; w[3][3][1] = -0.1106177597; w[3][3][2] = 1.0000000000;
  w[3][4][0] = 0.0003381375; w[3][4][1] = -0.3203815578; w[3][4][2] = 1.0000000000;
  w[3][5][0] = -0.0049771095; w[3][5][1] = -0.1951777718; w[3][5][2] = 1.0000000000;
  w[3][6][0] = -0.0057308080; w[3][6][1] = -0.1844013952; w[3][6][2] = 1.0000000000;
  w[3][7][0] = -0.0085649100; w[3][7][1] = -0.1634434000; w[3][7][2] = 1.0000000000;
  w[3][8][0] = -0.0087478980; w[3][8][1] = -0.1559930550; w[3][8][2] = 1.0000000000;
  w[3][9][0] = -0.0076033603; w[3][9][1] = -0.1543866326; w[3][9][2] = 1.0000000000;
  w[3][10][0] = 0.0061979930; w[3][10][1] = -0.2253933913; w[3][10][2] = 1.0000000000;
  w[4][1][0] = 0.0766940450; w[4][1][1] = -0.0279758579; w[4][1][2] = -1.0000000000;
  w[4][2][0] = -0.1891577297; w[4][2][1] = 2.4276998955; w[4][2][2] = 1.0000000000;
  w[4][3][0] = -0.1336598404; w[4][3][1] = 1.5470797820; w[4][3][2] = 1.0000000000;
  w[4][4][0] = 0.4115967390; w[4][4][1] = -1.4948501346; w[4][4][2] = 1.0000000000;
  w[4][5][0] = -0.0048292615; w[4][5][1] = -0.1880715603; w[4][5][2] = 1.0000000000;
  w[4][6][0] = 0.0085323580; w[4][6][1] = -0.2782819541; w[4][6][2] = 1.0000000000;
  w[4][7][0] = 0.0104867363; w[4][7][1] = -0.3025872361; w[4][7][2] = 1.0000000000;
  w[4][8][0] = 0.0092064313; w[4][8][1] = -0.2900036275; w[4][8][2] = 1.0000000000;
  w[4][9][0] = 0.0016997211; w[4][9][1] = -0.2495013265; w[4][9][2] = 1.0000000000;
  w[4][10][0] = 0.0019255098; w[4][10][1] = -0.2558959108; w[4][10][2] = 1.0000000000;
  w[5][1][0] = 0.1410895138; w[5][1][1] = -0.1850968410; w[5][1][2] = -1.0000000000;
  w[5][2][0] = -0.0245987287; w[5][2][1] = -0.1087505332; w[5][2][2] = 1.0000000000;
  w[5][3][0] = -0.1877743419; w[5][3][1] = 1.7303311545; w[5][3][2] = 1.0000000000;
  w[5][4][0] = -0.0153534582; w[5][4][1] = -0.0588259147; w[5][4][2] = 1.0000000000;
  w[5][5][0] = -0.0064414463; w[5][5][1] = -0.1877429412; w[5][5][2] = 1.0000000000;
  w[5][6][0] = -0.0043568807; w[5][6][1] = -0.1925663083; w[5][6][2] = 1.0000000000;
  w[5][7][0] = -0.0081728325; w[5][7][1] = -0.1707879273; w[5][7][2] = 1.0000000000;
  w[5][8][0] = -0.0061147264; w[5][8][1] = -0.1760014041; w[5][8][2] = 1.0000000000;
  w[5][9][0] = -0.0046055448; w[5][9][1] = -0.1815484789; w[5][9][2] = 1.0000000000;
  w[5][10][0] = 0.0061372514; w[5][10][1] = -0.2559176831; w[5][10][2] = 1.0000000000;
}

// 線形分類 from FakeSVM.cpp
// w[d][k][i]
bool useSolver(int N, int C, int D, int K) {
  return w[D][K][0] * N + w[D][K][1] * C + w[D][K][2] >= 0;
}

struct Board {
  int N, C, D, K;
  vector<vector<vector<double>>> prob;
  vector<pii> dij;

  Board(int N, int C, int D, int K, char* grid) : N(N), C(C), D(D), K(K) {
    prob = vector<vector<vector<double>>>(D + 1, vector<vector<double>>(N * N, vector<double>(C, 0)));
    for (int i = 0; i < N; i++) {
      for (int j = 0; j < N; j++) {
        int ij = i * N + j;
        prob[D][ij][grid[ij] - '0'] = 1.0;
      }
    }
    for (int di = -3; di <= 3; di++) {
      for (int dj = -3; dj <= 3; dj++) {
        if (di * di + dj * dj <= K) {
          dij.emplace_back(di, dj);
        }
      }
    }
    sort(dij.begin(), dij.end(), [](const pii& a, const pii& b) {
      return a.first * a.first + a.second * a.second < b.first * b.first + b.second * b.second;
    });
  }

  // d 日目 ij cell の情報を d-1 日目に伝搬させる
  void backward(int d, int ij) {
    int i = ij / N, j = ij % N;
    vector<pii> validPoints;
    for(const auto& p : dij) {
      int ni = i + p.first, nj = j + p.second;
      if (ni < 0 || ni >= N || nj < 0 || nj >= N) continue;
      validPoints.emplace_back(ni, nj);
    }
    int R = validPoints.size();
    for (const auto& p : validPoints) {
      int nij = p.first * N + p.second;
      for (int c0 = 0; c0 < C; c0++) {
        for (int c1 = 0; c1 < C; c1++) {
          double m = 0.0;
          if (nij != ij && c0 == c1) m = memo[R - 1][C][0];
          if (nij != ij && c0 != c1) m = memo[R - 1][C][1];
          if (nij == ij && c0 == c1) m = memo[R - 1][C][2];
          if (nij == ij && c0 != c1) m = memo[R - 1][C][3];
          prob[d - 1][nij][c0] += m * prob[d][ij][c1];
        }
      }
    }
  }

  void normalize(int d) {
    for (int ij = 0; ij < N * N; ij++) {
      double s = 0.0;
      for (int c = 0; c < C; c++) s += prob[d][ij][c];
      for (int c = 0; c < C; c++) prob[d][ij][c] /= s;
    }
  }

  void build() {
    for (int d = D; d >= 1; d--) {
      for (int ij = 0; ij < N*N; ij++) {
        backward(d, ij);
      }
      normalize(d - 1);
    }
  }

  vector<char> output(int d = 0) {
    vector<char> out(N * N);
    for (int ij = 0; ij < N * N; ij++) out[ij] = (max_element(prob[d][ij].begin(), prob[d][ij].end()) - prob[d][ij].begin()) + '0';
    return out;
  }
};

class GlowingBacteria {
public:
  vector<char> findSolution(int N, int C, int D, int K, char* grid) {
    initMemo();
    initWeight();
    if (useSolver(N, C, D, K)) {
      Board board(N, C, D, K, grid);
      board.build();
      return board.output();
    }
    else {
      vector<char> out(N*N);
      for (int i = 0; i < N * N; i++) out[i] = grid[i];
      return out;
    }
  }
};

int _main() {

  GlowingBacteria gb;
  int N;
  int C;
  int D;
  int K;
  cin >> N;
  cin >> C;
  cin >> D;
  cin >> K;

  char* grid = new char[N*N];
  for (int i = 0; i < N*N; i++) cin >> grid[i];

  vector<char> ret = gb.findSolution(N, C, D, K, grid);
  cout << ret.size() << endl;
  for (int i = 0; i < ret.size(); i++)
    cout << ret[i] << endl;
  cout.flush();

  return 0;
}


int getNextColor(const vector<int>& v) {
  map<int, int> colorMap;
  for (int i = 1; i < v.size(); i++) colorMap[v[i]]++;
  if (colorMap.size() == 1) return colorMap.begin()->first;
  vector<pii> colors;
  for (auto& e : colorMap) colors.push_back(e);
  sort(colors.begin(), colors.end(), [](const pii& a, const pii& b) {
    return a.second < b.second;
  });
  return colors[0].second == colors[1].second ? v[0] : colors[0].first;
}

template <typename T = int>
T ipow(T x, T n) {
  T ret = 1;
  for (T i = 0; i < n; i++) ret *= x;
  return ret;
}

template <typename _Ty> ostream& operator << (ostream& o, const vector<_Ty>& v) { if (v.empty()) { o << ""; return o; } o << "" << v.front(); for (auto itr = ++v.begin(); itr != v.end(); itr++) { o << "," << *itr; } o << ""; return o; }

int main() {
  const int C = 4, K = 5;
  // S^5 -> S
  int N = ipow(C, K);

  vector<vector<vector<int>>> a(K, vector<vector<int>>(C, vector<int>(C, 0)));
  
  for (int i = 0; i < N; i++) {
    int M(i);
    vector<int> v;
    for (int j = 0; j < K; j++) {
      v.push_back(M % C);
      M /= C;
    }
    reverse(v.begin(), v.end());
    int c = getNextColor(v);
    cerr << v << "->" << c << (i % 24 == 23 ? "\n" : ", ");

    for (int k = 0; k < K; k++) {
      a[k][c][v[k]]++;
    }
  }

  cerr << endl;

  for (auto& v : a) {
    for (auto& vv : v) {
      cerr << vv << endl;
    }
    cerr << endl;
  }

  return 0;
}