# MM115: GraphReconstruction

#### provisional  

standing: 22nd / 72  
score: 69.68135

## 概要

* グラフを再構成しなさ～い

## 垂れ流し

### 2/7

---

ソルバの<b>自明解</b>は全部の辺が 1 のやつ

じゃあ確率 C で適当に辺を張ったらどうなるの？→カス

---

明らかなのは

* (u, v, -1) のやつは辺を張らない
* (u, v, 1) のやつは辺を張る

自明から (u, v, -1) を除いたものを書いてみる

→ 自明の 110% くらい

---

無から (u, v, 1) を張ったものを書いてみる

→ 自明の 350% くらい

これが<b>団子解</b>だと予想

---

団子解は precision が 100% だが、recall は壊滅的

張った辺 / 全体 が C を超えるまで、ランダムに辺を張ってみる →カス

---

パスとホップ数に関する制約を<b>パス条件</b>、  
辺の張られる確率に関する制約 を<b>確率条件</b>とでも呼ぶことにする

ホップ数 2 以上のパス条件も満たすように辺を追加していくのが順当？  
このとき確率条件にも気を配る必要がある

パス条件 (u, v, -1) があるとき、u と v は disjoint である、という性質は重要そう  
(u, v, d) (d > 0) の辺で union-find をするとうれしそう

(u, v, -1) → u の含まれる集合と v の含まれる集合は disjoint  
これを使うとそれなりに -1 が確定する

あと忘れてたけど (u, v, d) (d > 1) のとき、辺 (u, v) が張られることはない

これで未確定辺を全体の 2/3 くらいまで減らせる

なんかパズル的要素を感じる

---

とりあえず残りを確定させる乱択を書く

スコアは適当にパス条件合致数とか？

→ 団子の 80/94 くらいしか出ない

---

張るエッジの数を固定して、エッジの張替えによる山登りを試してみる

→ 団子の 83/91 くらい

そろそろ解法で線形分離とかすれば団子の数点上くらいは狙えそうだけど、  
まだ明らかに見落としてる部分がありそうなので後回し

---

これは焼くやつでは

焼きなましに変更したところ団子の 92/78 くらいの得点が出た　やったぜ　焼けばなんとかなる

これと線形分離を組み合わせれば団子の 15 点くらい上、70 点台くらいは狙えるかな？

とりあえず first submit としてそのまま出したら 65.83969 点で 12 位　悪くはない

---

エッジ数固定でやってたけど、別に生やしたり消したりしてもよさそう

→ そんな大差ない

---

エッジ変更で都度 Warshall-Floyd を実行してスコア計算しているので seed 2 だと 6000 回くらいしか回らない

なんとか早くできないか？

→ BFS にして自前高速キューとか使ったら速度 10 倍くらいになった

点は 10 点くらい伸びて 74.62882 で 8 位

<img src=img/img1.PNG>

---

最上位が 85 点くらいだからまだ何かありそう

---

### 2/8

焼きなまし前の確定辺をもう少し増やせいないか？

パズル的に考えると、「辺を生やしたらor禁止したら矛盾が生じる」部分を探し出すような…

今まで見つけた定跡

1. パス条件 (u, v, 1) があるとき、辺 (u, v) を張る
1. パス条件 (u, v, -1) があるとき、辺 (u, v) は空き確定
1. パス条件 (u, v, d) (d > 1) があるとき、辺 (u, v) は空き確定
1. パス条件 (u, v, -1) があるとき、u と v は disjoint
    1. u が含まれる素集合 U の点から v が含まれる素集合 V の点への辺は全て空き確定

よって

1. 辺を張って矛盾チェック
    1. 矛盾なら空き確定
1. 辺を空き確定として矛盾チェック
    1. 矛盾なら辺を張る
1. それ以外なら、未確定

まずは深さ 1 でどんくらい行けるか見る

矛盾、全然見つからず　あれ～行けると思ったんだが

---

そもそも tester の True Graph の辺と初期解生成フェーズで確定した辺との validation をしていないので良くない

True Graph の情報を受け取るよう tester を改造して oracleTester をつくる

→ assert 入れたけどちゃんと合ってるっぽかった

あとは、シードに対する入力を吐くだけのテストケース収集用テスター改造もしたい

---

### 2/9

辺だけでなくパスに対しても"確定"の概念を考える  
初期解を作って辺を確定した後に、充足されるホップ数 2 以上のパスがあればそれは確定であるとする  
connected な辺のみで APSP を解いて、1 より大きい距離のパスについて距離が一致するなら確定  
確定したパスに対して、パスを短くするような辺は空き確定できる

まあ、パッと見て微妙な効果しかないけど…

提出したらなんか点上がって 75.76428 になった　たぶん誤差

---

円形グラフだと違いがわかりにくい　ビジュアライザ改造したい

たぶん方針は、

* パス制約を全て満たす解(充足解)を生成する
* 団子解と充足解のうち、期待値の高いほうを採用

だけど、現在充足解の生成に苦労している

焼きなまし高速化か、うまい遷移を思いつくか、はたまた探索か…

試しに時間 10 倍で回したら 91/78 くらいになった  
高速化も視野に入れておく（これ以上速くなると思えないが…）  

python 使いの nadare さんが良い順位なので焼かないのではないかと邪推しているけど、どうなんだろう？

---

### 2/13

何もわかんね～～　はなくそ　valentine 下痢 chocolate

